

<link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">

<!-- Linking Stylesheet-->
<?!= include("myStylesheet") ?>

<body>

  
 
<button id="customButton">Purchase</button>


<div class="myFooter">
  <span class="gray">
    Stategize.co</span>
</div>

</body>


<script src="https://checkout.stripe.com/checkout.js"></script>  
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<!-- Javascript to update Range Field -->

<script type="text/javascript">




    
//Purchase Button JS

var handler = StripeCheckout.configure(
{
  key: 'pk_test_UUbDY16wDCECOujIs0vQ2vTi',
  image: 'https://i.imgur.com/M0ku9HH.png',
  token: function(token) 
  {
    // Use the token to create the charge with a server-side script.
    // You can access the token ID with `token.id`
    google.script.run.withSuccessHandler(chargeSuccess)
    google.script.run.withFailureHandler(chargeFailure)
    google.script.run.processCharge(token);
  }
}
);

$('#customButton').on('click', function(e) 
{
  // Open Checkout with further options
  handler.open(
  {
    name: 'ASD Anastasiya Ballet S.',
    description: 'Pagamento online'
  });
  e.preventDefault();
});
function chargeSuccess(result) {
  // handle response code client side 
  // 
  /*
  var email = Session.getActiveUser().getEmail();
  var database = firebase.database();
  
 // Give tokens to new user
 
  //If user id doesn't exist
  function writeUserData(email, tokens) {
  firebase.database().ref('users/' + email).set({
   tokens: 50;
  });
  
  
  //Add Tokens to User.
  
  //
  //
  //
  tokenCountRef = tokenCountRef+valueFromOption;
  
  function writeUserData(email, tokens) {
  firebase.database().ref('users/' + email).set({
    tokens: tokenCountRef;
  });
  
  //Listen for token changes
  var tokenCountRef = firebase.database().ref('users/' + email + '/tokens');
tokenCountRef.on('value', function(snapshot) {
  updateTokenCount(postElement, snapshot.val());
  
  //Update HTML to show updated token count to user.
});
  
  On click run test:
  tokenCountRef--;
  function writeUserData(email, tokens) {
  firebase.database().ref('users/' + email).set({
    tokens: tokenCountRef;
  });
  
  */
}

function chargeFailure(error) {
  // client error handling
  //Some error Occurred.
}
</script>
